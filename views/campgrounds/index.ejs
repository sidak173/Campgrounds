<% layout('layout/boilerplate') %>
    <link href="https://api.mapbox.com/mapbox-gl-js/v2.6.0/mapbox-gl.css" rel="stylesheet">
    <script src="https://api.mapbox.com/mapbox-gl-js/v2.6.0/mapbox-gl.js"></script>




    <div id="map"></div>




    <div class="container mt-4">
        <% let geodata=[];%>
            <% for(let camp of campgrounds){ %>
                <% geodata.push(camp.geometry); %>
                    <div class="card mb-3 ">
                        <div class="row">
                            <div class="col-md-4 d-flex flex-column  justify-content-center align-content-center">
                                <img src="<%=camp.images.length? camp.images[0].url:'https://res.cloudinary.com/dy7obwtqp/image/upload/v1637529183/Campgrounds/no-image_lwgsh1.jpg' %> "
                                    alt="" class="img-fluid">
                            </div>
                            <div class="col-md-8 card-body d-flex flex-column justify-content-around">
                                <div class="card-title fw-bold h5" >
                                    <%= camp.title %>
                                </div>
                                <div class="card-text mb-1">
                                    <%= camp.description %>
                                </div>
                                <div class="card-text text-muted small mb-2">
                                    <%= camp.location %>
                                </div>
                                <div class="card-text">
                                    <a class="btn btn-primary" href="/campgrounds/<%=camp.id%> " role="button">View</a>
                                </div>
                            </div>
                        </div>
                    </div>

                    <% } %>
    </div>

    <script>
        mapboxgl.accessToken = '<%-process.env.MAPBOX_TOKEN%>';
        const campgrounds = {
            features: <%-JSON.stringify(campgrounds) %>
        }
    </script>
    <script src="clustermap.js"></script>